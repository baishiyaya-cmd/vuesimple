<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>NewVue Demo - Render Functions</title>
    <style>
      body { font-family: Arial, sans-serif; padding: 20px; }
      .card { border: 1px solid #ddd; padding: 12px; border-radius: 8px; margin-bottom: 10px; }
      .row { display: flex; gap: 8px; align-items: center; }
      .list { margin-top: 10px; }
      .item { display: flex; gap: 8px; align-items: center; }
      .muted { color: #999; }
      input { padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
      button { padding: 8px 16px; border: 1px solid #ddd; border-radius: 4px; cursor: pointer; background: white; }
      button:hover { background: #f0f0f0; }
    </style>
  </head>
  <body>
    <h1>NewVue Demo - ä½¿ç”¨æ¸²æŸ“å‡½æ•°</h1>
    <div id="app"></div>

    <script src="./newvue.js"></script>
    <script>
      const { h, ref, reactive, computed, defineComponent, createApp } = NewVue;

      // Counter ç»„ä»¶ - ä½¿ç”¨æ¸²æŸ“å‡½æ•°
      const Counter = defineComponent({
        name: 'Counter',
        props: { initial: { type: Number, default: 0 } },
        setup(props) {
          const count = ref(props.initial);
          const inc = () => count.value++;
          const dec = () => count.value--;
          
          return () => h('div', { class: 'card row' }, [
            h('button', { onclick: dec }, '-'),
            h('strong', {}, count.value),
            h('button', { onclick: inc }, '+'),
            h('span', { class: 'muted' }, '(render function)')
          ]);
        }
      });

      // ä¸»åº”ç”¨ç»„ä»¶
      const App = defineComponent({
        name: 'App',
        setup() {
          const state = reactive({
            title: 'Hello NewVue with Render Functions',
            msg: 'è¿™ä¸ªç‰ˆæœ¬ä½¿ç”¨æ¸²æŸ“å‡½æ•°è€Œä¸æ˜¯æ¨¡æ¿',
            input: 'Type here...',
            items: [
              { id: 1, text: 'Learn reactivity' },
              { id: 2, text: 'Practice render functions' },
              { id: 3, text: 'Build components' },
            ],
            nextId: 4
          });

          const itemCount = computed(() => state.items.length);
          
          function addItem() {
            state.items.push({ 
              id: state.nextId++, 
              text: 'New item #' + Date.now() 
            });
          }
          
          function shuffle() {
            state.items.sort(() => Math.random() - 0.5);
          }
          
          function removeFirst() {
            state.items.shift();
          }

          function updateInput(event) {
            state.input = event.target.value;
          }

          function updateItemText(item, event) {
            item.text = event.target.value;
          }

          return () => h('div', {}, [
            h('h2', {}, state.title),
            h('p', {}, state.msg),
            
            // è¾“å…¥æ¡†æ¼”ç¤º
            h('div', { class: 'card' }, [
              h('div', { class: 'row' }, [
                h('label', {}, 'Two-way binding: '),
                h('input', { 
                  value: state.input,
                  oninput: updateInput
                }),
                h('span', {}, ` => ${state.input}`)
              ])
            ]),

            // åˆ—è¡¨æ“ä½œæ¼”ç¤º
            h('div', { class: 'card' }, [
              h('div', { class: 'row' }, [
                h('button', { onclick: addItem }, 'Add item'),
                h('button', { onclick: shuffle }, 'Shuffle'),
                h('button', { onclick: removeFirst }, 'Remove first'),
                h('span', { class: 'muted' }, `(${itemCount.value} items)`)
              ]),
              h('div', { class: 'list' }, 
                state.items.map((item, i) => 
                  h('div', { class: 'item', key: item.id }, [
                    h('span', {}, `#${i}`),
                    h('input', { 
                      value: item.text,
                      oninput: (e) => updateItemText(item, e)
                    }),
                    h('span', {}, item.text)
                  ])
                )
              )
            ]),

            // Counter ç»„ä»¶
            h(Counter, { initial: 10 }),

            // æ¡ä»¶æ¸²æŸ“æ¼”ç¤º
            state.items.length > 0 ? h('div', { class: 'card' }, [
              h('em', {}, `æ¡ä»¶æ¸²æŸ“æ¼”ç¤º: æœ‰ ${state.items.length} ä¸ªé¡¹ç›®`)
            ]) : null,

            // åŠŸèƒ½è¯´æ˜
            h('div', { class: 'card' }, [
              h('h3', {}, 'ğŸš€ NewVue ç²¾ç®€ç‰ˆç‰¹æ€§'),
              h('ul', {}, [
                h('li', {}, 'âœ… å®Œæ•´çš„å“åº”å¼ç³»ç»Ÿ (reactive, ref)'),
                h('li', {}, 'âœ… è®¡ç®—å±æ€§å’Œä¾¦å¬å™¨ (computed, watch, watchEffect)'),
                h('li', {}, 'âœ… è™šæ‹Ÿ DOM ç³»ç»Ÿ (h, Fragment, Text)'),
                h('li', {}, 'âœ… ç»„ä»¶å®šä¹‰å’Œåº”ç”¨åˆ›å»º'),
                h('li', {}, 'âœ… æ–‡ä»¶å¤§å°å‡å°‘ 96.2% (ä» 555KB åˆ° 21KB)'),
                h('li', { style: { color: '#ff6b6b' } }, 'âŒ æ¨¡æ¿ç¼–è¯‘å™¨ (è¯·ä½¿ç”¨æ¸²æŸ“å‡½æ•°)')
              ])
            ])
          ]);
        }
      });

      // åˆ›å»ºå¹¶æŒ‚è½½åº”ç”¨
      const app = createApp(App);
      app.component('Counter', Counter);
      app.mount('#app');
    </script>
  </body>
</html>